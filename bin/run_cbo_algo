from cbo.CBO import *
import hydra
import logging
from omegaconf import OmegaConf
from cbo.utils_functions.utils import register_resolvers


@hydra.main(config_path="config", config_name="run_cbo")
def run_cbo(config):
    """
    Run the exploration set algorithm
    :param config: the hydra configuration
    """

    # Log the hydra configuration
    logging.info("Graph config:\n{}".format(OmegaConf.to_yaml(config)))

    # Run the causal Bayesian optimisation algorithm.
    CBO(config, verbose=True).run()


if __name__ == '__main__':
    """
    Script running the causal Bayesian optimisation algorithm.
    """
    register_resolvers()
    run_cbo()
